<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Mode Finder Â· Flavia Gaglio</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0d0b1a 0%, #1a142b 100%);
            color: #f0e9ff;
            font-family: 'Open Sans', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeInBody 1.2s ease-out;
        }
        @keyframes fadeInBody {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .container {
            max-width: 1200px;
            width: 100%;
            background: rgba(20, 15, 35, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 32px;
            padding: 2rem;
            box-shadow: 0 30px 60px rgba(0,0,0,0.7);
            animation: contenitoreAppare 1s ease-out;
        }
        @keyframes contenitoreAppare {
            from { opacity: 0; transform: translateY(30px) scale(0.98); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 3.5rem;
            text-align: center;
            background: linear-gradient(120deg, #f0e9ff, #c77dff, #9d4edd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            animation: floatTitle 3s infinite ease-in-out;
        }
        @keyframes floatTitle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .byline {
            text-align: center;
            font-size: 1.2rem;
            color: #c7b9ff;
            margin-bottom: 2rem;
            font-style: italic;
        }
        .selector-area {
            background: rgba(10, 8, 20, 0.8);
            border-radius: 28px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(157,78,221,0.3);
        }
        .selector-label {
            text-align: center;
            color: #9d4edd;
            margin-bottom: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .note-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            justify-content: center;
            margin-bottom: 2rem;
        }
        .note-btn {
            background: rgba(255,255,255,0.03);
            border: 2px solid #3c2a5a;
            color: #e0d0ff;
            width: 60px;
            height: 60px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 10px rgba(0,0,0,0.5);
        }
        @media (min-width: 480px) {
            .note-btn { width: 70px; height: 70px; font-size: 1.4rem; }
        }
        .note-btn.selected {
            background: #9d4edd;
            border-color: #f0e9ff;
            color: #0d0b1a;
            box-shadow: 0 0 25px #9d4edd;
        }
        .calculate-btn {
            background: linear-gradient(45deg, #9d4edd, #c77dff);
            color: #0d0b1a;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.2rem;
            cursor: pointer;
            width: 100%;
            max-width: 350px;
            margin: 0 auto;
            display: block;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .calculate-btn:active {
            transform: scale(0.97);
        }
        .modes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            animation: fadeInUp 0.8s ease-out;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .mode-card {
            background: rgba(30,20,45,0.9);
            border-radius: 24px;
            padding: 1.5rem;
            border-left: 6px solid;
            transition: transform 0.2s;
        }
        .mode-card:hover {
            transform: translateY(-5px);
        }
        .mode-card.major { border-left-color: #f72585; }
        .mode-card.minor { border-left-color: #ff9e00; }
        .mode-card.diminished { border-left-color: #b23b3b; }
        .mode-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6rem;
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        .mode-type {
            font-size: 0.8rem;
            background: rgba(255,255,255,0.1);
            padding: 0.2rem 0.8rem;
            border-radius: 20px;
            font-weight: 400;
        }
        .mode-notes {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            background: rgba(0,0,0,0.4);
            padding: 0.8rem;
            border-radius: 40px;
            text-align: center;
            margin-top: 0.5rem;
            letter-spacing: 1px;
        }
        footer {
            margin-top: 2rem;
            text-align: center;
            color: #6a5a8a;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¼ MODE FINDER</h1>
        <div class="byline">by Flavia Gaglio</div>

        <div class="selector-area">
            <div class="selector-label">fondamentale</div>
            <div class="note-grid" id="noteGrid"></div>
            <button class="calculate-btn" id="calculate">âœ¨ mostra i modi âœ¨</button>
        </div>

        <div id="modes-container" class="modes-grid"></div>
        <footer>maggiore Â· rosa | minore Â· arancio | diminuito Â· rosso</footer>
    </div>

    <script>
        (function() {
            // ---------- 1. Definizioni base ----------
            // Nomi in formato diesis (per tonalitÃ  con diesis)
            const SHARP_NOTES = ["Do", "Do#", "Re", "Re#", "Mi", "Fa", "Fa#", "Sol", "Sol#", "La", "La#", "Si"];
            // Nomi in formato bemolle (per tonalitÃ  con bemolli) 
            const FLAT_NOTES = ["Do", "Reb", "Re", "Mib", "Mi", "Fa", "Solb", "Sol", "Lab", "La", "Sib", "Si"];

            // Sequenze di intervalli (T=2, S=1) per ogni modo
            const MODE_PATTERNS = {
                ionico:     [2,2,1,2,2,2,1],
                dorico:     [2,1,2,2,2,1,2],
                frigio:     [1,2,2,2,1,2,2],
                lidio:      [2,2,2,1,2,2,1],
                misolidio:  [2,2,1,2,2,1,2],
                eolio:      [2,1,2,2,1,2,2],
                locrio:     [1,2,2,1,2,2,2]
            };

            // Nomi dei modi in italiano con qualitÃ 
            const MODE_NAMES = [
                { name: "Ionico", quality: "maggiore" },
                { name: "Dorico", quality: "minore" },
                { name: "Frigio", quality: "minore" },
                { name: "Lidio", quality: "maggiore" },
                { name: "Misolidio", quality: "maggiore" },
                { name: "Eolio", quality: "minore" },
                { name: "Locrio", quality: "diminuito" }
            ];

            // TonalitÃ  che usano i bemolli (circolo delle quinte)
            function useFlats(rootIndex) {
                // Fa (5), Sib (10), Mib (3), Lab (8), Reb (1), Solb (6)
                const flatKeys = [5, 10, 3, 8, 1, 6];
                return flatKeys.includes(rootIndex);
            }

            // ---------- 2. Stato ----------
            let selectedNoteIndex = 0; // Do
            const noteGrid = document.getElementById('noteGrid');
            const modesContainer = document.getElementById('modes-container');
            const calculateBtn = document.getElementById('calculate');

            // ---------- 3. Crea griglia note ----------
            SHARP_NOTES.forEach((note, index) => {
                const btn = document.createElement('button');
                btn.className = 'note-btn' + (index === 0 ? ' selected' : '');
                btn.textContent = note;
                btn.dataset.index = index;
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.note-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedNoteIndex = index;
                });
                noteGrid.appendChild(btn);
            });

            // ---------- 4. Costruisce un modo dato il pattern ----------
            function buildMode(rootIndex, pattern) {
                const notes = [rootIndex];
                let current = rootIndex;
                for (let interval of pattern) {
                    current = (current + interval) % 12;
                    notes.push(current);
                }
                notes.pop(); // rimuove l'ottava
                return notes; // 7 note
            }

            // ---------- 5. Genera tutti i modi ----------
            function generateAllModes(rootIndex) {
                const useFlat = useFlats(rootIndex);
                const noteNames = useFlat ? FLAT_NOTES : SHARP_NOTES;

                const modes = [];
                let index = 0;
                for (let [modeName, pattern] of Object.entries(MODE_PATTERNS)) {
                    const noteIndices = buildMode(rootIndex, pattern);
                    const noteStrings = noteIndices.map(i => noteNames[i]);
                    modes.push({
                        name: MODE_NAMES[index].name,
                        quality: MODE_NAMES[index].quality,
                        notes: noteStrings
                    });
                    index++;
                }
                return modes;
            }

            // ---------- 6. Render ----------
            function renderModes(rootIndex) {
                const modes = generateAllModes(rootIndex);
                let html = '';
                modes.forEach(mode => {
                    let modeClass = '';
                    if (mode.quality === 'maggiore') modeClass = 'major';
                    else if (mode.quality === 'minore') modeClass = 'minor';
                    else modeClass = 'diminished';

                    html += `
                        <div class="mode-card ${modeClass}">
                            <div class="mode-name">
                                ${mode.name}
                                <span class="mode-type">${mode.quality}</span>
                            </div>
                            <div class="mode-notes">${mode.notes.join(' Â· ')}</div>
                        </div>
                    `;
                });
                modesContainer.innerHTML = html;
            }

            // ---------- 7. Eventi e inizializzazione ----------
            calculateBtn.addEventListener('click', () => renderModes(selectedNoteIndex));
            renderModes(0); // Do all'avvio
        })();
    </script>
</body>
</html>
